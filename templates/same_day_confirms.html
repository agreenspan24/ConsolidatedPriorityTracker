{% extends "consolidated_tabs.html" %}

{% block table %}
    {% if shifts %}
        <thead class="thead">
            <tr>
                <th>VanID</th>
                <th>Name</th>
                <th>Phone</th>
                <th>Cell Phone</th>
                <th>Location</th>
                <th>Time</th>
                <th>Event</th>
                <th>Role</th>
                <th>Status</th>
                <th>New Note</th>
                <th></th>
            </tr>
        </thead>
        <tbody class="tbody">
            {% for shift in shifts %}
            {% if shift.status in ['Scheduled', 'Invited', 'Confirmed', 'Left Msg'] %}
                <tr>
                    <td>{{shift.person}}</td>
                    <td id="name-{{shift.id}}">{{shift.volunteer.first_name + ' ' + shift.volunteer.last_name}}</td>
                    <td>{{shift.volunteer.phone_number}}</td>
                    <td>{{shift.volunteer.cellphone}}</td>
                    <td>{{shift.shift_location.locationname}}</td>
                    <td>{{shift.time}}</td>
                    <td>{{shift.eventtype}}</td>
                    <td>{{shift.role}}</td>
                    <td>
                        <select id='status-{{shift.id}}' onchange="updateStatus({{shift.id}})" value='{{shift.status}}'>
                            <option value={{shift.status}}>{{shift.status}}</option>
                            <option value='Same Day Confirmed'>Same Day Confirmed</option>
                            <option value='In'>In</option>
                            <option value='Completed'>Completed</option>
                            <option value='Declined'>Declined</option>
                            <option value='No Show'>No Show</option>
                        </select>
                    </td>
                    <td>
                        <input id='note-{{shift.id}}' type='text'>
                    </td>
                    <td>
                        <a href="#" onclick="addNote({{shift.id}})">Add Note</a>
                    </td>
                    <!-- TODO:

                        Make moving users to KPH deliberate (create another table with "walkins to kph", backend combines them)
                        Make phonenumbers editable (like, modal on the number maybe? just some way to change it)
                        Same day confirm pass #s (has been added to model)
                        Select Menu for Status: Current Status, Completed, Declined, Flaked, In, Same Day Confirmed
                        ADD PASS RESULTS (text box attached to post "called" button that logs time, automatic saved via some JS magic?) Work flow (type in note, click called) it saves and adds a new row)

                        >>> from datetime import datetime
                        >>> time = datetime.now().time()
                        >>> note = Note('kps', time, "this is a test 1", 102684833, 9)
                        >>> db.session.add(note)
                        >>> db.session.commit()
                        >>> shift = Shift.query.filter_by(id=9).first()
                        >>> print(shift)
                        <Shift 9>
                        >>> print(shift.time)
                        18:00:00
                        >>> print(shift.notes)
                        [<Note 1>]
                        >>> for note in shift.notes:
                        ...     print(note.text)
                        ...
                        this is a test 1
                    
                    -->
                </tr>
            {% endif %}
            {% endfor %}
        </tbody>
    {% endif %}
{% endblock %}